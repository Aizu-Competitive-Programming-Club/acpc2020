## @{keyword.statement}

@{lang.ja}

B諸島とは南の海に浮かぶとある島々のことである。B諸島は近年温暖化による海面上昇の影響で、もともとは一つの島であったものがわかれたり、完全に沈んだりしている。そこで、今後の海面上昇による影響を調べるためにACPCにプログラムの作成を依頼することにした。

B諸島を含む海域は $H$ 行 $W$ 列のグリッド $B$ として表される。$B$ の $i$ 行 $j$ 列のマスが`#`であるときそこは陸であり、`.`のときそこは海である。全てのマスは陸か海のいずれかである。また、グリッドの外には海が広がっている。陸がグリッド上で上下左右に繋がってできる成分を一つの島と呼ぶ。プログラムはクエリに合計 $Q$ 回答えなければならない。$k=1,2,\ldots,Q$ 回目のクエリは以下のような形をしている。

- $r_k$ 行 $c_k$ 列の陸のマスが海に変わる。その変化の後のB諸島の島の数を答えよ。

ただしマスの変化は以降のクエリにも影響を及ぼすことに注意せよ。

ただしクエリの内容は暗号化されている。
$k$ 回目のクエリでの答えを $a_k$ とし、$s_l\ (l=0,\ldots,Q-1)$ を以下のように定める。

- $l=0$ ならば $s_l=0$
- $l>0$ ならば $s_l=@{param.roll}s_{l-1}+@{param.cst}a_l$

$r_k,c_k$ の値は以下のように表される。
$$r_k=1+((s_{k-1}\oplus u_k)\bmod{2^{10}}),\ c_k=1+((s_{k-1}\oplus v_k)\bmod{2^{10}})$$
$\oplus$ は排他的論理和という演算を表す。
より詳しくは非負整数 $x,y$ の2進数表記を $\displaystyle x=\sum_{n=0}^{\infty}x_n2^n,\ y=\sum_{n=0}^{\infty}y_n2^n\ (x_n,y_n\in\\{0,1\\} )$ としたとき、$x\oplus y$ は以下のように表される非負整数を表す。
$$x\oplus y=\sum_{n=0}^{\infty} ((x_n+y_n)\bmod 2)2^n$$

@{lang.end}

## @{keyword.constraints}

- $@{param.HW_MIN} \leq H,W \leq @{param.HW_MAX}$
- $@{param.Q_MIN} \leq Q \leq @{param.Q_MAX}$
- $B_{i,j}=$`#` または $B_{i,j}=$`.`
- $0\le u_k,v_k< 2^{10}=@{param.mod}$
- $1\le r_k \le H$
- $1\le c_k \le W$
- $k$番目のクエリを処理する直前の時点で $r_k$ 行 $c_k$ 列のマスは陸である

## @{keyword.input}

```
$H$ $W$ $Q$
$B_{1,1}\ldots B_{1,W}$
$\vdots$
$B_{H,1}\ldots B_{H,W}$
$u_1$ $v_1$
$\vdots$
$u_Q$ $v_Q$
```

## @{keyword.output}
各クエリに対して答えを一行に出力する。

## @{keyword.sample}

@{example.example_00}

$r_k,c_k$ は以下のようになっている。

```
3 2
2 3
2 1
1 2
2 2
```
一回目のクエリでは $3$ 行 $2$ 列の陸のマスが海のマスに変わり、陸は二つの島にわかれる。

@{example.example_01}

$r_k,c_k$ は以下のようになっている。

```
1 1
3 1
4 2
3 2
4 1
2 2
1 3
4 4
3 3
2 4
1 4
1 2
2 1
3 4
4 3
2 3
```